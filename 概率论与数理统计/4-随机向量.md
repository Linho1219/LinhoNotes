# 4 随机向量

二维随机变量也称二维随机向量。

## 联合分布函数与联合密度函数

### 联合分布函数

定义二维随机变量的联合分布函数 $F(x,y)$：

$$
F(x,y)=P(X\le x,Y\le y)
$$

其有如下性质：

- $0\le F(x,y)\le 1$
- $F(x,y)$ 对于其中任一自变量单调不减
- $F(x,y)$ 对于其中任一自变量右连续
- $\lim\limits_{\substack{x\to+\infty\\y\to+\infty}}F(x,y)=1$，$\lim\limits_{x\to-\infty}F(x,y)=1$，$\lim\limits_{y\to-\infty}F(x,y)=1$，

> [!important]
>
> 注意 $F(x,y)=1$ 的要求是 $x,y$ 均很大，$F(x,y)=0$ 的条件是 $x,y$ 任意一个很小。
>
> 这是因为分布函数的定义是两个随机变量**都小于**给定值的概率。因此只需任意一个给定值小，就很难达成（$P\to0$）；反过来如果要必然达成（$P\to1$），两个给定制都得很大才能做到。

若要求 $X,Y$ 各自落在某区间内的概率，有

$$
P(a\le X\le b,c\le Y\le d)=F(b,d)-F(b,c)-F(a,d)+F(a,c)
$$

画个图会很明白，$(a,c)$ 被减了两遍所以要补回来。

```graph
{
  data: [
    {
      fnType: "points",
      graphType: "polyline",
      points: [
        [1, 1],
        [3, 1],
        [3, 2],
        [1, 2],
        [1, 1],
      ],
    },
    {
      graphType: "text",
      text: "+(b, d)",
      location: [3, 2],
      color: "black",
    },
    {
      graphType: "text",
      text: "-(b, c)",
      location: [3, 1],
      color: "red",
    },
    {
      graphType: "text",
      text: "-(a, d)",
      location: [1, 2],
      color: "red",
    },
    {
      graphType: "text",
      text: "+(a, c)",
      location: [1, 1],
      color: "black",
    },
  ],
  annotations: [
    { y: 2 },
    { y: 1 },
    { x: 1 },
    { x: 3 },
  ],
  yAxis: { domain: [0, 3] },
  xAxis: { domain: [0, 4] },
}
```

### 联合密度函数

定义联合密度函数 $f(x,y)$ 满足

$$
\begin{gathered}
F(x,y)=\int_{-\infty}^x\int_{-\infty}^yf(u,v)\mathrm du\mathrm dv
\end{gathered}
$$

对于 $F(x,y)$ 连续处有

$$
f(x,y)=\frac{\partial ^2F(x,y)}{\partial x\partial y}
$$

联合密度函数有以下两个性质：

$$
\begin{gathered}
f(x,y)\ge 0 \\
\iint_{\mathbb R^2}f(x,y)=1
\end{gathered}
$$

对于任意平面区域 $D$ 有

$$
P((X,Y)\in D)=\iint_Df(x,y)\mathrm dx\mathrm dy
$$

## 边缘分布

## 协方差与相关系数

### 协方差

定义协方差：

$$
\operatorname {Cov}(X,Y)=E\{[X-E(X)][Y-E(Y)]\}
$$

相关的常用公式：

$$
\begin{gathered}
\operatorname {Cov}(X,Y)=E(XY)-E(X)E(Y) \\
\operatorname {Cov}(X,X)=\operatorname {Var}(X)\\
\operatorname {Cov}(kX,lY)=kl\operatorname {Cov}(X,Y)\\
\operatorname {Var}(X\pm Y)=\operatorname {Var}(X)+\operatorname {Var}(Y)\pm 2\operatorname {Cov}(X,Y) \\
\operatorname {Cov}\left(\sum_{i=1}^m X_i,\sum_{j=1}^n Y_j \right)=\sum_{i=1}^m \sum_{j=1}^n\operatorname {Cov}(X_i,Y_j)\\
\operatorname {Cov}(X,Y)=\operatorname {Cov}(Y,X)
\end{gathered}
$$

当 $X,Y$ 相互独立，有 $\operatorname {Cov}(X,Y)=0$

### 相关系数

定义相关系数

$$
\operatorname {Corr}(X,Y)={\operatorname {Cov}(X,Y) \over\sqrt{\operatorname {Var}(X)}\sqrt{\operatorname {Var}(Y)}}
$$

相关系数表征两个随机变量的线性相关性，有 $-1\le\operatorname {Corr}(X,Y)\le 1$。

若 $Y=aX+b$，则 $a>0$ 时 $\operatorname {Corr}(X,Y)=1$，$a<0$ 时 $\operatorname {Corr}(X,Y)=-1$。

当 $\operatorname {Corr}(X,Y)=0$ 时称 $X,Y$ 不相关。

## 二维正态

对于 $(X,Y)\sim N(\mu_1,\mu_2,\sigma_1^2,\sigma_2^2,\rho)$，有

$$
f(x,y)=\frac1{2\pi\sigma_1\sigma_2\sqrt{1-\rho^2}}
\exp\left\{
    -\frac1{2(1-\rho^2)}
    \left[
		\frac{(x-\mu_1)^2}{\sigma_1^2}
		-\frac{2\rho(x-\mu_1)(y-\mu_2)}{\sigma_1\sigma_2}
		+\frac{(y-\mu_2)^2}{\sigma_2^2}
    \right]
\right\}
$$

其中 $\rho$ 表示两个随机变量 $X,Y$ 的相关系数。下方的可交互图像中可以直观感受这一点（建议全屏）。

<<< ./images/2d-normal.ggb#3d
